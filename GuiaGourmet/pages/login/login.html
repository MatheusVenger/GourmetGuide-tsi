<!DOCTYPE html>
<html>
  <head>
      <title>Login</title>
      <meta name="viewport" content="width=device-width,initial-scale=1.0">
      <link rel="stylesheet" href="/GuiaGourmet/pages/mainpage/main.css">
      <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
     <style>
       body{
         background-color: #f0f0f0;
       }
     
       .progress{
         width:50%;
         margin:0 auto;
         margin-top:20%;
       }
       
       @media only screen and (max-width:924px){
            .progress{
               width:70%;
               margin:0 auto;
               margin-top:60%;
             }
       }
    
     </style>
  </head>
  
  <body>
    
    <!-- espaçamento -->
 <section class="espaco">
    <div class="row container">
        <div class="col s12">
            <h3> </h3>
        </div>
    </div>
 </section>
 <!-- espaçamento -->
 <section class="espaco">
    <div class="row container">
        <div class="col s12">
            <h3> </h3>
        </div>
    </div>
 </section>
 
  
 
 <!-- cadastro -->
    <section class="cadatro">
     <div id="flayer">
          <div id="slayer">
    
    <div class="container" id="content">
        
       
        <div class="row">
          <div class="col l3 m3 s12"></div>
          <div class="col l6 m6 s12">
            <form action="" method="POST">
                 <div class="card-panel z-depth-5">
                  <h5 class="center">Cadastre-se</h5>
                  <p class="center">Conheça os melhores do Mundo!</p>
                   <div class="input-field">
                    <i class="material-icons prefix">account_circle</i>
                    <input type="text" name="username" required>
                    <span class="error" id="error-user"></span>

                    <label>Enter username</label>
                  </div>
                  
                   <div class="input-field">
                    <i class="material-icons prefix">email</i>
                    <input type="email" name="email" class="validate" required>
                    <span class="error" id="error-email"></span>

                    <label>Enter email</label>
                  </div>
                  
                   <div class="input-field">
                    <i class="material-icons prefix">lock</i>
                    <input type="password" name="pass1" required>
                    <span class="error" id="error-pass"></span>

                    <label>Enter password</label>
                  </div>
                  
                    
                   <div class="input-field">
                    <i class="material-icons prefix">vpn_key</i>
                    <input type="password" name="pass2" required>
                    <label>Confirm password</label>
                  </div>
                  <p class="right">Já possui uma conta? <a href="#login" class="modal-trigger">login</a></p>
                  <a href="/pages/mainpage/main.html" value="Cadastre-se" class="btn left col s12 red darken-4">Cadastre-se</a>
                
                  <div class="clearfix"></div>
               </div>
            </form>
            
          </div>
            <div class="col l3 m3 s12"></div>
      
          
          
            </div>
        </div>
     </div>
 </div>
</section>
      
          <!-- login -->
    <section class="login">
        <div class="modal modal-fixed-footer" id="login">
            <form action="" method="POST">
             <div class="modal-conent">
              <div class="container">
                    <h5 class="center">Login</h5>
                  <p class="center">Bem vindo de volta!</p>
                  <div class="row">
                  
                    <div class="col m12 s12">
                      <div class="input-field">
                    <i class="material-icons prefix">person</i>
                    <input type="text" name="username" required>
                    <span class="error" id="error-login"></span>
                    <label>Enter username/email</label>
                  </div>
                  
                  <div class="input-field">
                    <i class="material-icons prefix">lock</i>
                    <input type="password" name="pass1" pattern = ".{8,}" required>
                    <span class="error" id="error-pass-login"></span>
                    <label>Enter password</label>
                  </div>
                  <p>
                    <label>
                      <input type="checkbox">
                      <span>Remember me</span>
                    </label>
                  </p>
                    </div>
                    
                  </div>
              </div>
            </div>
            
            <div class="modal-footer">
                  <div class="container">
                
                      
                         <p class="left">Novo aqui? <a href="/GuiaGourmet/pages/login/login.html" class="modal-trigger">Cadastre-se</a></p>
                         <a href="/pages/mainpage/main.html" class="btn pulse grey lighten-4 black-text"> Login</a>
                          <input type="button"  value="close" class="btn modal-close red darken-4">
                      </div>
     
               
                 
                  </div>
            </div>
         </form>
      </div>
</section>
    


    
    <section class="js">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
         <script>
    
      const login = document.querySelectorAll(".modal");
      M.Modal.init(login,{
        opacity:0.7,
        dismissible:false
      });
      
      document.querySelector("#content").style.display="none";
      document.querySelector("#flayer").classList.add("progress");
      document.querySelector("#slayer").classList.add("indeterminate");
      
      setTimeout(function(){
          document.querySelector("#flayer").classList.remove("progress");
          document.querySelector("#slayer").classList.remove("indeterminate");
          document.querySelector("#content").style.display="block";
      },3000)



      function limpaCampo() {
    let inputs = document.querySelectorAll('input');
    for (let element of inputs) {
        element.value = '';
    }
}

function salvarNoLocalStorage() {
    let nome = document.getElementById('input-nome').value;
    let email = document.getElementById('input-email').value;
    let senha = document.getElementById('input-senha').value;

    let usuario = { nome, email, senha };
    let usuarios = JSON.parse(localStorage.getItem("usuarios")) || [];

    usuarios.push(usuario);
    localStorage.setItem("usuarios", JSON.stringify(usuarios));
}

document.addEventListener("DOMContentLoaded", function () {
    const form = document.getElementById("form-cadastro");
    const inputs = document.querySelectorAll(".input");
    const checkboxTermos = document.getElementById("checkbox-termos");
    const btnRegistrar = document.getElementById("btn-registrar");
    const senhaInput = document.getElementById("input-senha");
    const confirmaSenhaInput = document.getElementById("input-confirma");
    const erroSenha = document.getElementById("erro-confirma");

    function validarSenha() {
        erroSenha.textContent = senhaInput.value !== confirmaSenhaInput.value ? "As senhas não coincidem!" : "";
        return erroSenha.textContent === "";
    }

    function validarFormulario() {
        let valido = Array.from(inputs).every(input => {
            let erroSpan = document.getElementById(`erro-${input.id.split('-')[1]}`);
            if (!input.checkValidity() || input.value.trim() === "") {
                erroSpan.textContent = `Por favor, preencha o campo ${input.name || input.id.split('-')[1]}.`;
                return false;
            }
            erroSpan.textContent = "";
            return true;
        });

        if (!checkboxTermos.checked || !validarSenha()) {
            valido = false;
        }

        btnRegistrar.disabled = !valido;
    }

    inputs.forEach(input => {
        input.addEventListener("input", validarFormulario);
        input.addEventListener("blur", validarFormulario);
    });

    checkboxTermos.addEventListener("change", validarFormulario);
    senhaInput.addEventListener("input", validarFormulario);
    confirmaSenhaInput.addEventListener("input", validarFormulario);

    form.addEventListener("submit", function (event) {
        event.preventDefault();
        
        salvarNoLocalStorage();
        recuperarDadosComAnimacao();

        $("#mensagem-sucesso").hide().slideDown(500).delay(2000).slideUp(500);

        form.reset();
    });
});


$(document).ready(function () {
    $("#input-nome").mask("A", { translation: { "A": { pattern: /[a-zA-Z\s]/, recursive: true } } });
    $("#input-email").mask("A", { translation: { "A": { pattern: /[a-zA-Z0-9@._-]/, recursive: true } } });
    $("#input-senha").mask("A", { translation: { "A": { pattern: /[a-zA-Z0-9]/, recursive: true } } });

    recuperarDadosComAnimacao();
});

function recuperarDadosComAnimacao() {
    let usuarios = JSON.parse(localStorage.getItem("usuarios")) || [];
    if (usuarios.length > 0) {
        let ultimoUsuario = usuarios[usuarios.length - 1];

        $("#usuario-nome").text(ultimoUsuario.nome);
        $("#usuario-email").text(ultimoUsuario.email);
        $("#dados-usuario").fadeIn(1000);
    }
}


    </script>
</section>  




</body>
</html>